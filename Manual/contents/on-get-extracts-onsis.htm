<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Adobe RoboHelp 2020" />
  <title>Get extracts from OnSIS</title>
  <link rel="StyleSheet" href="assets/css/default.css" type="text/css" />
  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
    //]]>
  </script>
  <style type="text/css">
  </style>
  <script type="text/javascript" src="template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="template/scripts/common.min.js"></script>
  <script type="text/javascript" src="template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="template/scripts/constants.js"></script>
  <script type="text/javascript" src="template/scripts/utils.js"></script>
  <script type="text/javascript" src="template/scripts/mhutils.js"></script>
  <script type="text/javascript" src="template/scripts/mhlang.js"></script>
  <script type="text/javascript" src="template/scripts/mhver.js"></script>
  <script type="text/javascript" src="template/scripts/settings.js"></script>
  <script type="text/javascript" src="template/scripts/XmlJsReader.js"></script>
  <script type="text/javascript" src="template/scripts/loadparentdata.js"></script>
  <script type="text/javascript" src="template/scripts/loadscreen.js"></script>
  <script type="text/javascript" src="template/scripts/loadprojdata.js"></script>
  <script type="text/javascript" src="template/scripts/mhtopic.js"></script>
  <link rel="stylesheet" type="text/css" href="template/styles/topic.min.css" />
  <script type="text/javascript">
    //<![CDATA[
    gRootRelPath = "..";
    gCommonRootRelPath = "..";
    gTopicId = "12.2.1.0_4";
    //]]>
  </script>
  <meta name="topic-breadcrumbs" content="Ontario &gt; OnSiS &gt; October elementary school" />
</head>
<body>
  <h1>Get extracts from OnSIS</h1>
  <hr align="center" style="color: rgb(72, 82, 92); font-family: Arial, Helvetica, sans-serif; 
	 font-size: 13.3333px; line-height: 13.3333px; orphans: auto; text-align: justify; 
	 widows: 1; -webkit-text-stroke-width: 0px; background-color: rgb;" />
  <p> </p>
  <p>The Get extracts from OnSIS card has no functionality other than to serve as a reminder to download extracts from OnSIS before beginning to use the SIS to create batch files. This card is available for these submission periods:</p>
  <p style="font-weight: normal;"> </p>
  <ul style="list-style: disc; font-weight: normal;">
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">October elementary school</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">October secondary school</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">March elementary school</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">March secondary school</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">June elementary school</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">June secondary school</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">Elementary school suspension/expulsion</p>
    </li>
    <li style="font-weight: normal;">
      <p style="font-weight: normal;">Secondary school suspension/expulsion</p>
    </li>
  </ul>
  <p> </p>
  <p>For these submission periods, selecting the INFO button on this card will open this page of the manual.</p>
  <p> </p>
  <p><img alt="" border="0" src="assets/images/on-get-extract-card.png" style=" border:none; width:100%; max-width:227px;" /></p>
  <p> </p>
  <p> </p>
  <p>Before creating any batch files in the SIS, and before submitting any batch files to OnSIS for processing, you must get extracts from OnSIS.</p>
  <p> </p>
  <p><a id="get_extracts_process"></a> <span style="font-weight:bold;font-size:18pt">Get Extracts Process</span></p>
  <p> </p>
  <p>If you are unsure how to get extracts from OnSIS, ask your board for assistance, or contact the OnSIS help desk. Use this general outline to perform the Get extracts process:</p>
  <p> </p>
  <ol style="list-style: decimal;">
    <li><span style="line-height:1.5;">Log into the Ministry’s OnSIS application.</span></li>
    <li><span style="line-height:1.5;">Within OnSIS, select Queries, Reports and Extracts (from the top menu bar).</span></li>
    <li><span style="line-height:1.5;">Select Run Extracts.</span></li>
    <li><span style="line-height:1.5;">Select SMS Extracts (SMS = student management system).</span></li>
    <li><span style="line-height:1.5;">Select Extracts List.</span></li>
    <li><span style="line-height:1.5;">Select Data Submission SMS Extracts.</span></li>
    <li><span style="line-height:1.5;">Enter the Academic Year (i.e. 2018-2019) and Submission Period (i.e. October).</span></li>
    <li><span style="line-height:1.5;">Select the button for Check All (to get all extract files).</span></li>
    <li><span style="line-height:1.5;">Select the button Run Immediately (further down the page) to generate the extract files.</span></li>
    <li><span style="line-height:1.5;">The screen should take you automatically to the list of the extracts being generated. Select Refresh until all extracts are shown in the lower portion of the screen under Generated Extracts. If it is not practical to wait for the extracts, go back to the OnSIS application at a later time and select Queries, Reports and Extracts, View Extracts.  </span></li>
    <li><span style="line-height:1.5;">Once all extracts are generated, select the Check All Generated Extracts button at the bottom. This will select all the files, then select Download Selected Extracts. From the prompt in the yellow window at the bottom of the screen, select on the down arrow beside Save and select Save As, and save the file in a secure location.</span></li>
    <li><span style="line-height:1.5;">The file that is downloaded from OnSIS, is a zip file containing all the generated extracts.  You now need to unzip this file.  From your Desktop, browse to the location where you saved the zip file (above), and open (double-click) this zip file. Select the Extract All Files option to unzip all the files in the same location. Make sure you know where the files are saved.</span></li>
  </ol>
  <p> </p>
  <p>Once the extract files are unzipped and stored locally, go into the edsembli SIS and follow these steps from the school (if the extracts contain info for one school), or from the board (if extracts were requested for multiple schools):</p>
  <p> </p>
  <ol style="list-style: decimal;">
    <li><span style="line-height:1.5;">Select File manager (from the main menu in edsembli SIS).</span></li>
    <li><span style="line-height:1.5;">From the Location card, open the folder tree to Provincial &gt; OnSIS &gt; Extracts &gt; October (or the submission period you are about to work on).  The Files card will show this location, and typically the folder will be empty unless files were previously added here.</span></li>
  </ol>
  <p> </p>
  <p style="margin-left: 40px;"><img alt="" border="0" src="assets/images/on-get-extract.png" style=" border:none; width:100%; max-width:790px;" /></p>
  <p> </p>
  <ol start="3" style="list-style: decimal;">
    <li>Select the Add icon in the card app bar.<br />
      <br />
      <img alt="" border="0" src="assets/images/on-get-extract1.png" style="border: none; width: 100%; max-width: 788px;" />
    </li>
  </ol>
  <p> </p>
  <ol start="4" style="list-style: decimal;">
    <li>Browse to find the extracts which were downloaded earlier (in step 12). Select all the extract files (hint CTRL or SHIFT while selecting files will allow multiple files to be selected).  Once the files are selected, use the Open button to down load them.<br />
      <br />
      <img alt="" border="0" src="assets/images/on-get-extract2.png" style=" border:none; width:100%; max-width:790px;" />
    </li>
  </ol>
  <p> </p>
  <ol start="5" style="list-style: decimal;">
    <li>Make sure all the extracts are listed in file manager in the Files card.</li>
  </ol>
  <p style="margin-left: 40px; font-weight: bold;"><span style="color: #007fff;">Due to the confidential information in the extract files from OnSIS, you may want to remove the files from step 12 if they are not in a secure location.</span></p>
  <p> </p>
  <h2><a id="fyi_prepopulated_data/extracts"></a> FYI - Pre-populated data and extracts</h2>
  <p> </p>
  <p>Once a submission period is newly opened, the OnSIS application will sometimes pre-populate the submission period with data from the previous submission period. For example, when you start a secondary school submission period in October, you will find that it already contains the students who did not leave the school in the June submission period.</p>
  <p> </p>
  <p>As batch files are created by the SIS, it is important for the SIS to know whether the data is pre-populated. If the data already exists, the SIS batch file sends an UPDATE action, and if it doesn’t, it sends an ADD action. If the wrong action is sent in the batch file, OnSIS will return an error.</p>
  <p> </p>
  <p>The only way to know whether the data already exists is through the use of extracts. The extracts are comma delimited files (.CSV files) that the Ministry’s OnSIS application generates following a specific layout that the SIS will use to determine whether to send the ADD or UPDATE action.</p>
  <p> </p>
  <p>When extracts are generated by the Ministry’s application, by default they are given a name such as  <span style="color: #007fff;">EXSMS-0001.00200906090952122.CSV</span>. The first part of the extract contains the number we use to identify this extract (e.g. we would refer to this extract as extract 0001).</p>
  <p> </p>
  <p>An extract will look something like this, where the H1 and H2 header records provide information about the submission, and school identification, followed by D2 detail records detailing the data in OnSIS at the time the extract was created. The detail records change depending on the type of extract, and multiple schools can exist in an extract (handy for boards submitting data through the board rather than the individual schools). This is a sample class list extract:</p>
  <p> </p>
  <p><img alt="" border="0" src="assets/images/on-get-extract3.png" style="border: none; width: 100%; max-width: 773px;" /></p>
  <p> </p>
</body>
</html>